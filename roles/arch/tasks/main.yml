# SPDX-License-Identifier: MIT-0
---
- name: Install packages
  community.general.pacman:
    name: >-
      {{ item }}
    state: present
  loop:
    - ansible
    - direnv
    - glances
    - hddtemp
    - mosh
    - pre-commit
    - python-pip
    - python-virtualenv
    - pkgstats
  become: true
- name: Update package cache
  community.general.pacman:
    executable: yay
    update_cache: true
- name: Install glances
  ansible.builtin.pip:
    virtualenv: /etc/glances/
    name: >-
      {{ item }}
    state: present
  loop:
    - pip
    - glances
    - zeroconf
  become: true
- name: Install glances services
  ansible.builtin.copy:
    src: >-
      {{ item }}
    dest: >-
      /usr/lib/systemd/system/{{ item }}
    owner: root
    group: root
    mode: ug+rw
  loop:
    - glances.service
    - glances-exporter.service
  become: true
- name: Start glances services
  ansible.builtin.service:
    name: >-
      {{ item }}
    state: started
    enabled: true
  loop:
    - glances
    - glances-exporter
  become: true
